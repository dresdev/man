!function(){const e=(e,t=document)=>t.querySelector(e),t=(e,t=document)=>Array.from(t.querySelectorAll(e)),n=(e,t,n,s)=>e&&e.addEventListener(t,n,s||{passive:!0}),s="mreader:favorites",i="app:recent-searches",o=5,a=e=>{try{return JSON.parse(localStorage.getItem(e))??[]}catch{return[]}},c=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch{}},r=window.MANGA_CONFIG||{},l=r.mangas||[],d=r.sections||[],p=r.featuredId||"",h=new Map(l.map((e=>[e.id,e])));function y(e){window.location.href=`go:${e}`}function m(e){const t=new Set,n=[];for(const s of e)h.has(s)&&(t.has(s)||(t.add(s),n.push(s)));return n}function u(e){const t=document.createElement("div");return t.className="poster",t.innerHTML=`<img src="${e.poster}" alt="${e.title||e.id}" /><div class="title">${e.title||e.id}</div>`,n(t,"click",(()=>y(e.id))),t}function f(){const t=a(s),n=e("#home-favs-section"),i=e("#homeFavs");if(n&&i)if(i.innerHTML="",Array.isArray(t)&&0!==t.length){n.style.display="";for(const e of t){const t={id:e.slug||e.id||"manga",title:e.title||e.slug||e.id||"Manga",poster:e.cover||e.poster||""};i.appendChild(u(t))}}else n.style.display="none"}function g(n){t(".view").forEach((e=>e.hidden=!0));const i=e(`#view-${n}`);i&&(i.hidden=!1),t(".bottom-nav button").forEach((e=>e.classList.toggle("active",e.dataset.view===n))),"home"===n&&f(),"favs"===n&&function(){const t=a(s),n=e("#favsGrid"),i=e("#emptyFavs");if(n&&i){if(n.innerHTML="",!Array.isArray(t)||0===t.length)return n.style.display="none",void(i.style.display="flex");n.style.display="grid",i.style.display="none";for(const e of t){const t={id:e.slug||e.id||"manga",title:e.title||e.slug||e.id||"Manga",poster:e.cover||e.poster||""};n.appendChild(u(t))}}}()}function v(){!function(){const t=h.get(p);if(!t)return;const n=e("#hero"),s=e("#heroPoster"),i=e("#heroBg"),o=e("#heroTitle"),a=e("#heroCategories");s&&(s.src=t.poster),i&&(i.style.backgroundImage=`url('${t.poster}')`),o&&(o.textContent=t.title||t.id),a&&(a.textContent=t.categories?.join(" â€¢ ")||""),n&&(n.onclick=()=>y(t.id))}(),function(){const t=e("#sectionsContainer");if(t){t.innerHTML="";for(const e of d){const n=m(e.items),s=document.createElement("section");s.className="section",s.innerHTML=`<h3 class="section-title">${e.title}</h3>`;const i=document.createElement("div");i.className="poster-row",n.forEach((e=>{const t=h.get(e);t&&i.appendChild(u(t))})),s.appendChild(i),t.appendChild(s)}}}(),f(),function(){const t=e("#searchInput"),s=e("#recentList"),r=e("#resultsList"),d=e("#resultsSection"),p=e("#clearHistory");function m(){const t=a(i),n=e("#recentSearches"),o=e(".search-section-header",n);if(!t.length)return n&&(n.style.display="none"),void(o&&(o.style.display="none"));n&&(n.style.display="block"),o&&(o.style.display="flex"),s.innerHTML="",t.forEach((e=>{const t=h.get(e);if(!t)return;const n=document.createElement("div");n.className="search-item",n.innerHTML=`\n          <img src="${t.poster}" alt="${t.title}">\n          <div class="search-item-info">\n            <h4 class="search-item-title">${t.title}</h4>\n            <div class="search-item-categories">\n              ${t.categories.map((e=>`<span class="search-item-category">${e}</span>`)).join("")}\n            </div>\n          </div>\n        `,n.onclick=()=>u(t),s.appendChild(n)}))}function u(e){const n=a(i),s=[e.id,...n.filter((t=>t!==e.id))].slice(0,o);c(i,s),t.value="",d.style.display="none",m(),y(e.id)}t&&s&&r&&(n(t,"input",(()=>{const n=t.value.trim().toLowerCase();r.innerHTML="";const s=e("#recentSearches");if(!n)return d.style.display="none",void(s&&(s.style.display="block"));s&&(s.style.display="none");const i=l.filter((e=>e.title.toLowerCase().includes(n)||e.categories.some((e=>e.toLowerCase().includes(n)))));i.length>0?(d.style.display="block",i.forEach((e=>{const t=document.createElement("div");t.className="search-item",t.innerHTML=`\n            <img src="${e.poster}" alt="${e.title}">\n            <div class="search-item-info">\n              <h4 class="search-item-title">${e.title}</h4>\n              <div class="search-item-categories">\n                ${e.categories.map((e=>`<span class="search-item-category">${e}</span>`)).join("")}\n              </div>\n            </div>\n          `,t.onclick=()=>u(e),r.appendChild(t)}))):(d.style.display="none",s&&(s.style.display="none"))})),p&&(p.onclick=()=>{const t=e("#recentSearches"),n=e(".search-section-header",t);t&&(t.style.display="none"),n&&(n.style.display="none"),c(i,[]),m()}),m())}(),t(".bottom-nav button").forEach((e=>n(e,"click",(()=>g(e.dataset.view)))))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",v,{once:!0}):v()}();